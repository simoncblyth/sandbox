# https://docs.docker.com/reference/dockerfile/#automatic-platform-args-in-the-global-scope
ARG IMAGE_REF
FROM --platform=$BUILDPLATFORM $IMAGE_REF

ARG TARGETARCH
ARG TARGETOS
ARG TARGETPLATFORM

ARG BUILDARCH
ARG BUILDOS
ARG BUILDPLATFORM


RUN echo "TARGETPLATFORM $TARGETPLATFORM"
RUN echo "TARGETOS       $TARGETOS"
RUN echo "TARGETARCH     $TARGETARCH"

RUN echo "BUILDPLATFORM  $BUILDPLATFORM"
RUN echo "BUILDOS        $BUILDOS"
RUN echo "BUILDARCH      $BUILDARCH"


CMD echo $((40 + 2))
CMD nvidia-smi


